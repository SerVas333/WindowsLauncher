<!-- ===== WindowsLauncher.UI/App.xaml - ИСПРАВЛЕННАЯ ФИНАЛЬНАЯ ВЕРСИЯ ===== -->
<Application x:Class="WindowsLauncher.UI.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <!-- ✅ УБРАЛИ StartupUri - запуск управляется через App.xaml.cs -->

    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- ========== ПОДКЛЮЧЕНИЕ СТИЛЕВЫХ РЕСУРСОВ ========== -->

                <!-- 1. Базовые цвета Material Design -->
                <ResourceDictionary Source="Styles/MaterialColors.xaml"/>

                <!-- 2. Стили элементов Material Design -->
                <ResourceDictionary Source="Styles/MaterialStyles.xaml"/>

                <!-- 3. Корпоративные стили KDV (расширяют Material) -->
                <ResourceDictionary Source="Styles/CorporateStyles.xaml"/>

                <!-- ✅ УБРАЛИ StringResources.xaml - используем .resx -->

            </ResourceDictionary.MergedDictionaries>

            <!-- ========== FALLBACK ИКОНКИ ========== -->

            <!-- Иконка лаунчера -->
            <DrawingImage x:Key="LauncherIconFallback">
                <DrawingImage.Drawing>
                    <DrawingGroup>
                        <GeometryDrawing Brush="{StaticResource PrimaryBrush}">
                            <GeometryDrawing.Geometry>
                                <RectangleGeometry Rect="0,0,48,48" RadiusX="8" RadiusY="8"/>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="{StaticResource OnPrimaryBrush}">
                            <GeometryDrawing.Geometry>
                                <GeometryGroup>
                                    <RectangleGeometry Rect="8,8,12,12"/>
                                    <RectangleGeometry Rect="28,8,12,12"/>
                                    <RectangleGeometry Rect="8,28,12,12"/>
                                    <RectangleGeometry Rect="28,28,12,12"/>
                                </GeometryGroup>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                    </DrawingGroup>
                </DrawingImage.Drawing>
            </DrawingImage>

            <!-- Логотип KDV -->
            <DrawingImage x:Key="KdvLogoFallback">
                <DrawingImage.Drawing>
                    <DrawingGroup>
                        <GeometryDrawing Brush="{StaticResource PrimaryBrush}">
                            <GeometryDrawing.Geometry>
                                <EllipseGeometry Center="30,30" RadiusX="28" RadiusY="28"/>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="{StaticResource OnPrimaryBrush}">
                            <GeometryDrawing.Geometry>
                                <PathGeometry>
                                    <PathFigure StartPoint="12,20">
                                        <LineSegment Point="12,40"/>
                                        <LineSegment Point="15,40"/>
                                        <LineSegment Point="15,32"/>
                                        <LineSegment Point="22,40"/>
                                        <LineSegment Point="26,40"/>
                                        <LineSegment Point="18,30"/>
                                        <LineSegment Point="26,20"/>
                                        <LineSegment Point="22,20"/>
                                        <LineSegment Point="17,27"/>
                                        <LineSegment Point="15,25"/>
                                        <LineSegment Point="15,20"/>
                                        <LineSegment Point="12,20"/>
                                    </PathFigure>
                                </PathGeometry>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                    </DrawingGroup>
                </DrawingImage.Drawing>
            </DrawingImage>

            <!-- Иконка приложения по умолчанию -->
            <DrawingImage x:Key="DefaultAppIconFallback">
                <DrawingImage.Drawing>
                    <DrawingGroup>
                        <GeometryDrawing Brush="{StaticResource SecondaryBrush}">
                            <GeometryDrawing.Geometry>
                                <RectangleGeometry Rect="0,0,32,32" RadiusX="4" RadiusY="4"/>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="{StaticResource OnSecondaryBrush}">
                            <GeometryDrawing.Geometry>
                                <EllipseGeometry Center="16,16" RadiusX="8" RadiusY="8"/>
                            </GeometryDrawing.Geometry>
                        </GeometryDrawing>
                    </DrawingGroup>
                </DrawingImage.Drawing>
            </DrawingImage>

            <!-- ========== ГЛОБАЛЬНЫЕ СТИЛИ ========== -->

            <!-- Базовый стиль для всех окон -->
            <Style TargetType="Window">
                <Setter Property="FontFamily" Value="Segoe UI"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Background" Value="{StaticResource BackgroundBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource OnBackgroundBrush}"/>
                <Setter Property="Icon" Value="{StaticResource LauncherIconFallback}"/>
            </Style>

            <!-- Применяем Material стили как стили по умолчанию -->
            <Style TargetType="TextBox" BasedOn="{StaticResource MaterialTextBoxStyle}"/>
            <Style TargetType="PasswordBox" BasedOn="{StaticResource MaterialPasswordBoxStyle}"/>
            <Style TargetType="Button" BasedOn="{StaticResource MaterialButtonStyle}"/>
            <Style TargetType="CheckBox" BasedOn="{StaticResource MaterialCheckBoxStyle}"/>
            <Style TargetType="RadioButton" BasedOn="{StaticResource MaterialRadioButtonStyle}"/>

            <!-- Корпоративный стиль для TextBlock по умолчанию -->
            <Style TargetType="TextBlock" BasedOn="{StaticResource CorporateBodyText}"/>

            <!-- ========== ДОПОЛНИТЕЛЬНЫЕ СТИЛИ ========== -->

            <!-- Стиль для заголовков страниц -->
            <Style x:Key="PageTitle" TargetType="TextBlock" BasedOn="{StaticResource CorporateTitle}">
                <Setter Property="Margin" Value="0,0,0,20"/>
                <Setter Property="HorizontalAlignment" Value="Left"/>
            </Style>

            <!-- Стиль для подзаголовков -->
            <Style x:Key="SectionTitle" TargetType="TextBlock" BasedOn="{StaticResource CorporateSubtitle}">
                <Setter Property="Margin" Value="0,15,0,10"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
            </Style>

            <!-- Стиль для контейнеров -->
            <Style x:Key="ContentContainer" TargetType="Border">
                <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="20"/>
                <Setter Property="Margin" Value="10"/>
                <Setter Property="BorderBrush" Value="{StaticResource OutlineBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
            </Style>

            <!-- ========== ШАБЛОНЫ СООБЩЕНИЙ ========== -->

            <!-- Шаблон для ошибок -->
            <DataTemplate x:Key="ErrorTemplate">
                <Border Background="{StaticResource ErrorLightBrush}" 
                        CornerRadius="4" 
                        Padding="15,10" 
                        Margin="5">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="⚠" 
                                   FontSize="16" 
                                   Foreground="{StaticResource ErrorBrush}"
                                   Margin="0,0,10,0"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding}" 
                                   Foreground="{StaticResource ErrorBrush}"
                                   TextWrapping="Wrap"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </DataTemplate>

            <!-- Шаблон для успешных сообщений -->
            <DataTemplate x:Key="SuccessTemplate">
                <Border Background="{StaticResource SuccessLightBrush}" 
                        CornerRadius="4" 
                        Padding="15,10" 
                        Margin="5">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="✓" 
                                   FontSize="16" 
                                   Foreground="{StaticResource SuccessBrush}"
                                   Margin="0,0,10,0"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding}" 
                                   Foreground="{StaticResource SuccessBrush}"
                                   TextWrapping="Wrap"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </DataTemplate>

        </ResourceDictionary>
    </Application.Resources>
</Application>