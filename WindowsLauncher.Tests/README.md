# WindowsLauncher.Tests

Проект модульного и интеграционного тестирования для WindowsLauncher.

## Структура тестов

### Services/Lifecycle/
- **ApplicationLifecycleServiceTests.cs** - Смоковые тесты для основного сервиса управления жизненным циклом приложений
- **Launchers/LauncherIntegrationTests.cs** - Интеграционные тесты для специализированных лаунчеров
- **Windows/WindowManagerTests.cs** - Тесты для управления окнами
- **Monitoring/ProcessMonitorTests.cs** - Тесты для мониторинга процессов

## Фреймворки тестирования

- **xUnit** - Основной фреймворк для unit тестов
- **Moq** - Библиотека для создания mock объектов
- **Microsoft.NET.Test.Sdk** - SDK для запуска тестов

## Запуск тестов

### Из Visual Studio
1. Откройте solution `WindowsLauncher.sln`
2. Build → Build Solution
3. Test → Run All Tests

### Из командной строки
```bash
# Перейти в корень проекта
cd /mnt/c/WindowsLauncher

# Запустить все тесты
dotnet test

# Запустить тесты с подробным выводом
dotnet test --verbosity normal

# Запустить тесты с coverage
dotnet test --collect:"XPlat Code Coverage"

# Запустить конкретный класс тестов
dotnet test --filter "ClassName=ApplicationLifecycleServiceTests"

# Запустить тесты по имени метода
dotnet test --filter "MethodName~LaunchAsync"
```

## Типы тестов

### 1. Смоковые тесты (Mock Tests)
- **ApplicationLifecycleServiceTests** - проверяют бизнес-логику с замоканными зависимостями
- Проверяют корректность вызовов методов зависимостей
- Тестируют обработку ошибок и edge cases
- Проверяют события и их передачу

### 2. Интеграционные тесты
- **LauncherIntegrationTests** - проверяют взаимодействие лаунчеров
- Тестируют определение типов приложений
- Проверяют валидацию входных параметров

### 3. Компонентные тесты
- **WindowManagerTests** - тестируют логику управления окнами
- **ProcessMonitorTests** - тестируют логику мониторинга процессов

## Покрытие тестами

### ApplicationLifecycleService
- ✅ Запуск/остановка мониторинга
- ✅ Запуск приложений разных типов
- ✅ Переключение между приложениями
- ✅ Получение списка запущенных приложений
- ✅ Завершение процессов
- ✅ Обработка событий
- ✅ Валидация входных параметров
- ✅ Обработка исключений

### Launchers
- ✅ Определение поддерживаемых типов приложений
- ✅ Валидация параметров запуска
- ✅ Обработка несовместимых приложений
- ✅ Проверка различных форматов URL и путей

### WindowManager
- ✅ Операции с окнами (переключение, изменение состояния, закрытие)
- ✅ Получение информации об окнах
- ✅ Валидация параметров

### ProcessMonitor
- ✅ Запуск/остановка мониторинга
- ✅ Получение информации о процессах
- ✅ Проверка состояния процессов
- ✅ Завершение процессов
- ✅ Обработка событий процессов

## Рекомендации по добавлению тестов

### Новые тесты должны:
1. Следовать паттерну AAA (Arrange, Act, Assert)
2. Иметь понятные имена методов, описывающие тестируемый сценарий
3. Проверять один аспект функциональности
4. Включать тесты на edge cases и обработку ошибок
5. Использовать Theory для параметризованных тестов

### Пример структуры теста:
```csharp
[Fact]
public async Task MethodName_WithSpecificCondition_ShouldExpectedBehavior()
{
    // Arrange
    var input = CreateTestInput();
    var expectedResult = "expected value";
    
    // Act
    var result = await _service.MethodAsync(input);
    
    // Assert
    Assert.Equal(expectedResult, result.Value);
}
```

## Ограничения текущих тестов

### Не тестируется в реальной среде:
- Реальные запуски приложений (используются моки)
- Windows API вызовы (требуют реальной системы)
- Файловые операции (можно добавить с временными файлами)
- Сетевые запросы (можно добавить с mock серверами)

### Для полного покрытия потребуется:
- End-to-End тесты с реальными приложениями
- Performance тесты для мониторинга
- Stress тесты для множественных запусков
- UI тесты для интеграции с переключателем приложений

## Настройки тестов

- **xunit.runner.json** - конфигурация для xUnit runner
- **Timeout по умолчанию**: нет (тесты должны завершаться быстро)
- **Параллельное выполнение**: включено
- **Диагностические сообщения**: включены для отладки