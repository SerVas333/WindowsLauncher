# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Å–µ–Ω—Å–æ—Ä–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã Windows 10

## –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ VirtualKeyboardService

–°–µ—Ä–≤–∏—Å –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Windows API –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–∫–∞–∑–æ–º TabTip.exe –≤ Windows 10.

### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞–ø—É—Å–∫–∞

1. **Windows API –ø–æ–∏—Å–∫ –∏ –ø–æ–∫–∞–∑** - –ò—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–∫–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —á–µ—Ä–µ–∑ `FindWindow()` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ `ShowWindow()`

2. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ CMD** - –£–±–∏–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã TabTip –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π —á–µ—Ä–µ–∑ cmd.exe

3. **–†–µ–µ—Å—Ç—Ä + –∑–∞–ø—É—Å–∫** - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `EnableDesktopModeAutoInvoke=1` –≤ —Ä–µ–µ—Å—Ç—Ä–µ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç TabTip

4. **Fallback –Ω–∞ OSK** - –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —ç–∫—Ä–∞–Ω–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `DiagnoseVirtualKeyboardAsync()` –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ TabTip.exe –∏ OSK.exe
- –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- –û–∫–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä —á–µ—Ä–µ–∑ Windows API
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–µ—Å—Ç—Ä–∞

## –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `WindowsLauncher.UI` –≤ Visual Studio (F5)
2. –í –æ–∫–Ω–µ –≤—Ö–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üî§" (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞)
3. –ë—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–∫–∞–∑–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
4. –ï—Å–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è, –ø–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 2. –ê–Ω–∞–ª–∏–∑ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

–í –æ–∫–Ω–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
=== –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –í–ò–†–¢–£–ê–õ–¨–ù–û–ô –ö–õ–ê–í–ò–ê–¢–£–†–´ ===
TabTip.exe —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: True/False
–ü—É—Ç—å TabTip: C:\Program Files\Common Files\microsoft shared\ink\TabTip.exe
OSK.exe —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: True/False
–ü—É—Ç—å OSK: C:\Windows\System32\osk.exe
–ü—Ä–æ—Ü–µ—Å—Å–æ–≤ TabTip –∑–∞–ø—É—â–µ–Ω–æ: 0
–ü—Ä–æ—Ü–µ—Å—Å–æ–≤ OSK –∑–∞–ø—É—â–µ–Ω–æ: 0
–û–∫–Ω–æ —Å–µ–Ω—Å–æ—Ä–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–∞–π–¥–µ–Ω–æ: False
–û–∫–Ω–æ OSK –Ω–∞–π–¥–µ–Ω–æ: False
–†–µ–µ—Å—Ç—Ä EnableDesktopModeAutoInvoke:
  - Exit Code: 0/1
  - Output: ...
=== –ö–û–ù–ï–¶ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò ===
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ **View ‚Üí Output** –≤ Visual Studio –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "WindowsLauncher.UI Debug".
–ò—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
```
[Information] –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–∫–∞–∑–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
[Information] –ó–∞–ø—É—Å–∫ TabTip —á–µ—Ä–µ–∑ cmd: C:\Program Files\Common Files\microsoft shared\ink\TabTip.exe
[Information] –ü—ã—Ç–∞–µ–º—Å—è –≤–∫–ª—é—á–∏—Ç—å —Å–µ–Ω—Å–æ—Ä–Ω—É—é –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —á–µ—Ä–µ–∑ —Ä–µ–µ—Å—Ç—Ä
[Information] TabTip –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—â–µ–Ω –∏ –ø–æ–∫–∞–∑–∞–Ω
```

### 4. –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ TabTip

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```cmd
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞
dir "C:\Program Files\Common Files\microsoft shared\ink\TabTip.exe"

# –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é
"C:\Program Files\Common Files\microsoft shared\ink\TabTip.exe"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
tasklist | findstr TabTip

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–µ—Å—Ç—Ä–∞
reg add "HKCU\Software\Microsoft\TabletTip\1.7" /v EnableDesktopModeAutoInvoke /t REG_DWORD /d 1 /f
```

### 5. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ OSK

–ï—Å–ª–∏ TabTip –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ OSK:
```cmd
# –ó–∞–ø—É—Å–∫ OSK
osk.exe

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
tasklist | findstr osk
```

## –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### TabTip.exe –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** Windows 10 –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–∫–∞–∑ TabTip –Ω–∞ –æ–±—ã—á–Ω—ã—Ö –ü–ö –±–µ–∑ —Å–µ–Ω—Å–æ—Ä–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞

**–†–µ—à–µ–Ω–∏—è:**
1. **–í–∫–ª—é—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Windows:**
   - –û—Ç–∫—Ä—ã—Ç—å Settings ‚Üí Ease of Access ‚Üí Keyboard
   - –í–∫–ª—é—á–∏—Ç—å "Use the On-Screen Keyboard"

2. **–†–µ–µ—Å—Ç—Ä:**
   ```reg
   [HKEY_CURRENT_USER\Software\Microsoft\TabletTip\1.7]
   "EnableDesktopModeAutoInvoke"=dword:00000001
   ```

3. **–°–ª—É–∂–±–∞ TabletInputService:**
   ```cmd
   net start TabletInputService
   ```

### –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ –æ–∫–Ω–æ –Ω–µ –≤–∏–¥–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞:** TabTip —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ –Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç UI

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `FindWindow()` –∏ `ShowWindow()` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞

### OSK –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–†–µ—à–µ–Ω–∏–µ:** 
```cmd
sfc /scannow
dism /online /cleanup-image /restorehealth
```

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Group Policy –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥—ã

```reg
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\TabletTip\1.7]
"EnableDesktopModeAutoInvoke"=dword:00000001
"EnableAutomaticInvocation"=dword:00000001
```

### PowerShell —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```powershell
# EnableTouchKeyboard.ps1
$regPath = "HKCU:\Software\Microsoft\TabletTip\1.7"
if (!(Test-Path $regPath)) {
    New-Item -Path $regPath -Force
}
Set-ItemProperty -Path $regPath -Name "EnableDesktopModeAutoInvoke" -Value 1
Restart-Service TabletInputService -Force
Write-Host "Touch keyboard enabled"
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ Event Viewer

1. –û—Ç–∫—Ä–æ–π—Ç–µ Event Viewer
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Application and Services Logs
3. –ò—â–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç TabTip –∏–ª–∏ TouchKeyboard

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

- [ ] TabTip.exe —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: ___
- [ ] TabTip –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é: ___  
- [ ] TabTip –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: ___
- [ ] OSK —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ fallback: ___
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∫–∞–∑ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ: ___
- [ ] –†–µ–µ—Å—Ç—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ: ___

**–í–µ—Ä—Å–∏—è Windows:** _______________
**–°–µ–Ω—Å–æ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω:** –î–∞ / –ù–µ—Ç
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞–±–æ—Ç–∞–µ—Ç / –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç / –ß–∞—Å—Ç–∏—á–Ω–æ

---

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º.